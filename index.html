<!DOCTYPE HTML>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>MiMi</title>

        <link href="https://fonts.cdnfonts.com/css/jetbrains-mono" rel="stylesheet">

        <style>
            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }

            :root  {
                --background-color: #1a1316;
                --text-color: #eae6e1;
                --accent-color: #e5b97f;
            }

            body {
                background-color: var(--background-color);
                color: var(--text-color);
                font-family: "JetBrains Mono", monospace;
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
            }

            .terminal {
                width: 800px;
                height: 600px;
                border: 1px solid #2a2024;
                display: flex;
                flex-direction: column;
                z-index: 1;

                background-color: rgba(30, 22, 25, 0.6);
                backdrop-filter: blur(12px);
                -webkit-backdrop-filter: blur(12px);
            }

            .topbar {
                height: 32px;
                border-bottom: 1px solid #2a2024;
                padding: 0 5px;
                align-items: center;
                display: flex;
                user-select: none;
                position: relative;
                background-color: #1e1619;
            }

            .title {
                font-size: 12px;
                color: #d8d3ce;
                letter-spacing: 0.4px;
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
            }

            .version {
                font-size: 10px;
                color: #7a7276;
            }

            .buttons {
                display: flex;
                gap: 6px;
                margin-left: auto;
            }

            .button {
                font-size: 12px;
                color: #d8d3ce;
                background-color: #1e1619;
                border: 1px solid #2a2024;
                padding: 3px 10px;
                cursor: pointer;
            }

            .content {
                flex: 1;
                padding: 8px 10px;
                font-size: 13px;
                line-height: 1.6;
                overflow: hidden;
                display: flex;
                flex-direction: column;
            }

            .content pre, .content canvas {
                width: 100%;
                max-width: 800px;
                overflow: hidden;
                font-size: 10px;
                line-height: 10px;
            }

            .line {
                display: inline-flex;
                flex-wrap: wrap;
                align-items: center;
            }

            .prompt {
                color: var(--accent-color);
                margin-right: 5px;
                font-weight: 500;
            }

            .accent {
                color: var(--accent-color);
                margin-right: 5px;
            }

            .input-container {
                display: inline-flex;
                align-items: center;
                position: relative;
            }

            .input {
                outline: none;
                color: var(--text-color);
                font-family: inherit;
                white-space: pre;
                caret-color: transparent;
            }

            .cursor {
                display: inline-block;
                width: auto;
                background: none;
                color: var(--accent-color);
                animation: blink 1s steps(2, start) infinite;
                margin-left: 1px;
            }

            .cursor::after {
                content: "_";
            }

            .char-count {
                font-size: 10px;
                color: #7a7276;
                margin-left: 6px;
                user-select: none;
            }

            /* Icons */
            .icon-cog {
                width: 16px;
                height: 16px;
                vertical-align: middle;
                image-rendering: pixelated;
            }

            .icon-hand-heart {
                width: 16px;
                height: 16px;
                vertical-align: middle;
                image-rendering: pixelated;
            }

            .modal {
                position: fixed;
                top: 0; left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(26, 19, 22, 0.85);
                display: none;
                justify-content: center;
                align-items: center;
                z-index: 9999;
            }

            .modal-topbar {
                height: 32px;
                border-bottom: 1px solid #2a2024;
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 0 5px;
                background-color: #1e1619;
            }

            .modal-window {
                width: 400px;
                max-width: 90%;
                border: 1px solid #2a2024;
                background-color: #1a1316;
                display: flex;
                flex-direction: column;
            }

            .modal-title {
                font-size: 12px;
                color: #d8d3ce;
                letter-spacing: 0.4px;
                text-align: center;
                flex: 1;
                user-select: none;
            }

            .modal-window .button {
                font-size: 12px;
                color: #d8d3ce;
                background-color: #1e1619;
                border: 1px solid #2a2024;
                padding: 3px 10px;
                cursor: pointer;
            }

            .modal-content {
                padding: 10px;
                font-size: 13px;
                color: #eae6e1;
                display: flex;
                flex-direction: column;
                gap: 4px;
            }

            .user-id {
                font-size: 10px;
                color: #7a7276;
            }

            .link-container {
                display: flex;
                align-items: center;
                justify-content: flex-start;
                gap: 8px;
                padding: 6px 12px;
                min-width: 150px;
                height: auto;
                border: 1px solid #2a2024;
                background-color: #1e1619;
                cursor: pointer;
                transition: all 0.2s ease;
                flex-direction: row;
            }

            .link-container:hover {
                background-color: #2a1f23;
                border-color: var(--accent-color);
            }

            .github-logo {
                width: 20px;
                height: 20px;
            }

            .link-text-wrapper {
                display: flex;
                flex-direction: column;
                gap: 2px;
            }

            .link-text {
                font-size: 13px;
                font-weight: 500;
                color: #eae6e1;
            }

            .link-subtext {
                font-size: 10px;
                color: #7a7276;
            }

            @keyframes blink {
                0%, 100% {
                    opacity: 1;
                }

                50% {
                    opacity: 0;
                }
            }
        </style>
    </head>

    <body>
        <div class="terminal">
            <div class="topbar">
                <div class="title"># Miraii <span class="version">v1.0.0</span></div>

                <div class="buttons">
                    <div class="button" id="credits-button">
                        <i data-lucide="hand-heart" class="icon-hand-heart"></i>
                    </div>

                    <div class="button">
                        <i data-lucide="cog" class="icon-cog"></i>
                    </div>
                </div>
            </div>

            <div class="content">
                <div class="line">
                    <span class="prompt">miraii@terminal</span>
                    <span class="accent">~/</span>

                    <span class="input-container">
                        <span class="input" contenteditable="true" autofocus></span>
                        <span class="cursor"></span>
                        <span class="char-count">0/45</span>
                    </span>
                </div>
            </div>
        </div>

        <div class="modal" id="credits-modal">
            <div class="modal-window">
                <div class="modal-topbar">
                    <div class="modal-title"># Credits</div>

                    <div class="buttons">
                        <div class="button" id="close-modal">x</div>
                    </div>
                </div>

                <div class="modal-content">
                    <p>Made by Miraii <span class="user-id">(@844900332303024128)</span></p>

                    <div class="link-container">
                        <img src="https://icon.icepanel.io/Technology/png-shadow-512/GitHub.png" class="github-logo" alt="GitHub">

                        <div class="link-text-wrapper">
                            <span class="link-text">Github</span>
                            <span class="link-subtext">Github Pages</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://unpkg.com/lucide@latest"></script>

        <script id="char-handler">
            const input = document.querySelector(".input");
            const char_count = document.querySelector(".char-count");
            const content = document.querySelector(".content");
            const max_chars = 45;

            const commands = {
                help: "Current Commands: help, logs, matrix.",
                logs: "Redirect To Weekly Logs."
            };

            input.addEventListener("input", () => {
                if (input.textContent.length > max_chars) {
                    input.textContent = input.textContent.slice(0, max_chars);

                    place_caret_end(input);
                }

                char_count.textContent = `${input.textContent.length}/${max_chars}`;
            });

            input.addEventListener("keydown", (_) => {
                if (_.key === "Enter") {
                    _.preventDefault();
                    execute(input.textContent.trim());

                    input.textContent = "";
                    char_count.textContent = `0/${max_chars}`;
                }

                if (_.key === "Backspace") {
                    _.preventDefault();

                    const text = input.textContent;

                    input.textContent = text.slice(0, text.length - 1);
                    place_caret_end(input);
                    char_count.textContent = `${input.textContent.length}/${max_chars}`;
                }
            })

            // Helpers:
            function place_caret_end(element) {
                const range = document.createRange();
                const select = window.getSelection();

                range.selectNodeContents(element);
                range.collapse(false);
                select.removeAllRanges();
                select.addRange(range);
            }

            let no_matrix = null;

            function execute(raw_command) {
                const command = raw_command.toLowerCase().trim().replace(/^command\s+/, "");

                const line = document.createElement("div");
                const prompt = document.createElement("span");
                const accent = document.createElement("span");
                const output = document.createElement("span");

                line.className = "line";
                prompt.className = "prompt";
                prompt.textContent = "miraii@terminal";
                accent.className = "accent";
                accent.textContent = "~/";
                output.style.marginLeft = "5px";

                if (command === "logs") {
                    setTimeout(() => {
                        window.location.href = "logs.html";
                    }, 500);

                    return;
                }

                if (command === "matrix") {
                    if (!no_matrix) {
                        no_matrix = matrix();
                        output.textContent = "Matrix !!!";
                    } else {
                        no_matrix();
                        no_matrix = null;
                        output.textContent = "Stopped.";
                    }

                    line.appendChild(prompt);
                    line.appendChild(accent);
                    line.appendChild(output);
                    content.appendChild(line);
                    content.scrollTop = content.scrollHeight;

                    return;
                }

                output.textContent = commands[command] || `The Command '${command}' Wasn't Found !`;

                line.appendChild(prompt);
                line.appendChild(accent);
                line.appendChild(output);
                content.appendChild(line);

                content.scrollTop = content.scrollHeight;
            }

            function matrix() {
                const canvas = document.createElement("canvas");
                const context = canvas.getContext("2d");
                const terminal = document.querySelector(".terminal");

                canvas.id = "matrix_background";
                document.body.appendChild(canvas)

                canvas.style.position = "fixed";
                canvas.style.top = 0;
                canvas.style.left = 0;
                canvas.style.width = "100%";
                canvas.style.height = "100%";
                canvas.style.zIndex = -9999;
                canvas.style.pointerEvents = "none";

                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;

                const letters = "ミレイミレイミレイMIRAI010101".split("");
                const font_size = 14;
                const columns = canvas.width / font_size;
                const drops = Array(Math.floor(columns)).fill(1);

                function draw() {
                    context.fillStyle = "rgba(26, 19, 22, 0.05)";
                    context.fillRect(0, 0, canvas.width, canvas.height);
                    context.fillStyle = "#e5b97f";
                    context.font = font_size + "px JetBrains Mono";

                    for (let i = 0; i < drops.length; i++) {
                        const text = letters[Math.floor(Math.random() * letters.length)];

                        context.fillText(text, i * font_size, drops[i] * font_size);

                        if (drops[i] * font_size > canvas.height && Math.random() > 0.975) {
                            drops[i] = 0;
                        }

                        drops[i]++;
                    }
                }

                const interval = setInterval(draw, 40);

                window.addEventListener("resize", () => {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                });

                return () => {
                    clearInterval(interval);
                    canvas.remove();
                };
            }

            lucide.createIcons();
        </script>

        <script>
            const credits_button = document.getElementById("credits-button");
            const modal = document.getElementById("credits-modal");
            const close_button = document.getElementById("close-modal");

            credits_button.addEventListener("click", () => {
                modal.style.display = "flex";
            });

            close_button.addEventListener("click", () => {
                modal.style.display = "none";
            });

            modal.addEventListener("click", (event) => {
                if (event.target === modal) {
                    modal.style.display = "none";
                }
            });
        </script>
    </body>
</html>
